<!-- <!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ポケモン図鑑</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/modern-css-reset/dist/reset.min.css"
    />
    <link rel="stylesheet" href="./css/style.css" />
    <style></style>
  </head>
  <body>
    <header class="pokemon-header">
      <div class="inner">
        <h1 class="pokemon-title">ポケモン図鑑</h1>
      </div>
    </header>
    <main>
      <div class="swipe-box"></div>
      <div class="content">
        <div class="inner">
          <div class="d-pokemon-down">
            <label for="sort-select">並び順: </label>
            <select id="sort-select">
              <option value="number-asc">ナンバー順 (早いやつ)</option>
              <option value="number-desc">ナンバー順 (遅いやつ)</option>
              <option value="name-asc">名前順 (A~)</option>
              <option value="name-desc">名前順 (Z~)</option>
            </select>
          </div>
          <div id="pokedex-container"></div>
        </div>
      </div>
    </main>
    <footer class="footer"></footer>

    <script>
      //ポケモン取得
      async function getPokemonData(url) {
        const response = await fetch(url);
        const data = await response.json();
        return data;
      }

      function displayPokemonData(pokemonData, pokedexContainer) {
        //ポケモンの情報を入れる箱
        const pokemonElement = document.createElement("div");
        pokemonElement.className = "pokemon";

        //ポケモンの画像を取ってくる（箱を作るのはobject-fit:cover用）
        const pokemonImageElement = document.createElement("div");
        pokemonImageElement.className = "pokemon-imgframe";
        const pokemonImage = document.createElement("img");
        pokemonImage.className = "pokemon-image";
        pokemonImage.src = pokemonData.sprites.front_default;
        pokemonImage.alt = "Pokemon";
        pokemonImageElement.appendChild(pokemonImage);

        //ポケモンの図鑑番号の取得（#0000にするための処理済み）
        const pokemonIdElement = document.createElement("p");
        pokemonIdElement.className = "pokemon-id";
        pokemonIdElement.textContent = `#${pokemonData.id
          .toString()
          .padStart(4, "0")}`;

        //ポケモンの名前取得
        const pokemonNameElement = document.createElement("h2");
        pokemonNameElement.className = "pokemon-name";
        pokemonNameElement.textContent = pokemonData.name;

        //ポケモンのタイプ取得(forEachで配列を順にとる）
        const pokemonTypeElement = document.createElement("p");
        pokemonTypeElement.className = "pokemon-type";
        pokemonData.types.forEach((typeData) => {
          const typeElement = createTypeElement(typeData.type.name);
          pokemonTypeElement.appendChild(typeElement);
        });

        //今まで入れた内容を一度箱に入れる
        pokemonElement.appendChild(pokemonImageElement);
        pokemonElement.appendChild(pokemonIdElement);
        pokemonElement.appendChild(pokemonNameElement);
        pokemonElement.appendChild(pokemonTypeElement);

        //全てのポケモンを入れる
        pokedexContainer.appendChild(pokemonElement);

        //押されたら詳細ページに飛ばす
        pokemonElement.addEventListener("click", () => {
          window.location.href = `pokemon.html?id=${pokemonData.id}`;
        });
      }

      //タイプ取得→spanに入れる→タイプごとにクラスをつけるためそのタイプ名をあげる
      function createTypeElement(type) {
        const typeElement = document.createElement("span");
        typeElement.textContent = type;
        typeElement.classList.add("type", `type-${type}`);
        return typeElement;
      }

      async function createPokedex() {
        //入れる大きい箱２つだよ。
        const pokedexContainer = document.getElementById("pokedex-container");
        const sortSelect = document.getElementById("sort-select");

        try {
          //ポケモン情報取得
          const response = await fetch(
            "https://pokeapi.co/api/v2/pokemon?limit=151"
          );
          const data = await response.json();
          const pokemonList = data.results;

          //プルダウンリストが変わったら
          sortSelect.addEventListener("change", async () => {
            //一旦中身をなくす
            pokedexContainer.innerHTML = "";

            //プルダウンのvalueの値を一旦格納する
            const sortValue = sortSelect.value;
            let sortedPokemonList = [];

            //プルダウンのvalueの値を比べる
            switch (sortValue) {
              case "number-asc":
                //これが普通の順
                sortedPokemonList = pokemonList;
                break;
              case "number-desc":
                //逆から取得
                sortedPokemonList = pokemonList.slice().reverse();
                break;
              case "name-asc":
                //aから1ずつ変わってく
                sortedPokemonList = pokemonList
                  .slice()
                  .sort((a, b) => (a.name > b.name ? 1 : -1));
                break;
              case "name-desc":
                //さっきの逆
                sortedPokemonList = pokemonList
                  .slice()
                  .sort((a, b) => (a.name < b.name ? 1 : -1));
                break;
            }

            //今取得したポケモン情報をurlから全て出す
            for (const pokemon of sortedPokemonList) {
              const pokemonData = await getPokemonData(pokemon.url);
              displayPokemonData(pokemonData, pokedexContainer);
            }
          });

          //プルダウンが選ばれたら発火
          sortSelect.value = "number-asc";
          sortSelect.dispatchEvent(new Event("change"));
        } catch (error) {
          console.log("Error:", error);
        }
      }

      window.addEventListener("load", createPokedex);
    </script>
  </body>
</html> -->

<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ポケモン図鑑</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/modern-css-reset/dist/reset.min.css"
    />
    <link rel="stylesheet" href="./css/style.css" />
  </head>
  <body>
    <header class="pokemon-header">
      <div class="inner">
        <h1 class="pokemon-title">ポケモン図鑑</h1>
      </div>
    </header>
    <main>
      <div class="swiper">
        <div class="swipe-box swiper-wrapper"></div>
      </div>
      <div class="content">
        <div class="inner">
          <div class="d-pokemon-down">
            <label for="sort-select">並び順: </label>
            <select id="sort-select">
              <option value="number-asc">ナンバー順 (早いやつ)</option>
              <option value="number-desc">ナンバー順 (遅いやつ)</option>
              <option value="name-asc">名前順 (A~)</option>
              <option value="name-desc">名前順 (Z~)</option>
            </select>
          </div>
          <div id="pokedex-container"></div>
        </div>
      </div>
    </main>
    <footer class="footer"></footer>

    <script>
      //ポケモン取得
      async function getPokemonData(url) {
        const response = await fetch(url);
        const data = await response.json();
        return data;
      }

      function displayPokemonData(pokemonData, pokedexContainer) {
        //ポケモンの情報を入れる箱
        const pokemonElement = document.createElement("div");
        pokemonElement.className = "pokemon";

        //このクラスを親に持つ要素のみクラス付与
        const swipeBox = document.querySelector(".swipe-box");
        if (swipeBox) {
          pokemonElement.classList.add("swiper-slide");
        }

        //ポケモンの画像を取ってくる（箱を作るのはobject-fit:cover用）
        const pokemonImageElement = document.createElement("div");
        pokemonImageElement.className = "pokemon-imgframe";
        const pokemonImage = document.createElement("img");
        pokemonImage.className = "pokemon-image";
        pokemonImage.src = pokemonData.sprites.front_default;
        pokemonImage.alt = "Pokemon";
        pokemonImageElement.appendChild(pokemonImage);

        //ポケモンの図鑑番号の取得（#0000にするための処理済み）
        const pokemonIdElement = document.createElement("p");
        pokemonIdElement.className = "pokemon-id";
        pokemonIdElement.textContent = `#${pokemonData.id
          .toString()
          .padStart(4, "0")}`;

        //ポケモンの名前取得
        const pokemonNameElement = document.createElement("h2");
        pokemonNameElement.className = "pokemon-name";
        pokemonNameElement.textContent = pokemonData.name;

        //ポケモンのタイプ取得(forEachで配列を順にとる）
        const pokemonTypeElement = document.createElement("p");
        pokemonTypeElement.className = "pokemon-type";
        pokemonData.types.forEach((typeData) => {
          const typeElement = createTypeElement(typeData.type.name);
          pokemonTypeElement.appendChild(typeElement);
        });

        //今まで入れた内容を一度箱に入れる
        pokemonElement.appendChild(pokemonImageElement);
        pokemonElement.appendChild(pokemonIdElement);
        pokemonElement.appendChild(pokemonNameElement);
        pokemonElement.appendChild(pokemonTypeElement);

        //全てのポケモンを入れる
        pokedexContainer.appendChild(pokemonElement);

        //押されたら詳細ページに飛ばす
        pokemonElement.addEventListener("click", () => {
          window.location.href = `pokemon.html?id=${pokemonData.id}`;
        });
      }

      //タイプ取得→spanに入れる→タイプごとにクラスをつけるためそのタイプ名をあげる
      function createTypeElement(type) {
        const typeElement = document.createElement("span");
        typeElement.textContent = type;
        typeElement.classList.add("type", `type-${type}`);
        return typeElement;
      }

      async function createPokedex() {
        //入れる大きい箱２つだよ。
        const pokedexContainer = document.getElementById("pokedex-container");
        const swipeBox = document.querySelector(".swipe-box");

        try {
          //ランダムなポケモン情報を取得
          const randomPokemonUrls = await getRandomPokemonUrls(5);
          for (const url of randomPokemonUrls) {
            const pokemonData = await getPokemonData(url);
            displayPokemonData(pokemonData, swipeBox);
          }

          //ポケモン情報取得
          const response = await fetch(
            "https://pokeapi.co/api/v2/pokemon?limit=151"
          );
          const data = await response.json();
          const pokemonList = data.results;

          //プルダウンリストが変わったら
          const sortSelect = document.getElementById("sort-select");
          sortSelect.addEventListener("change", async () => {
            //一旦中身をなくす
            pokedexContainer.innerHTML = "";

            //プルダウンのvalueの値を一旦格納する
            const sortValue = sortSelect.value;
            let sortedPokemonList = [];

            //プルダウンのvalueの値を比べる
            switch (sortValue) {
              case "number-asc":
                //これが普通の順
                sortedPokemonList = pokemonList;
                break;
              case "number-desc":
                //逆から取得
                sortedPokemonList = pokemonList.slice().reverse();
                break;
              case "name-asc":
                //aから1ずつ変わってく
                sortedPokemonList = pokemonList
                  .slice()
                  .sort((a, b) => (a.name > b.name ? 1 : -1));
                break;
              case "name-desc":
                //さっきの逆
                sortedPokemonList = pokemonList
                  .slice()
                  .sort((a, b) => (a.name < b.name ? 1 : -1));
                break;
            }

            //今取得したポケモン情報をurlから全て出す
            for (const pokemon of sortedPokemonList) {
              const pokemonData = await getPokemonData(pokemon.url);
              displayPokemonData(pokemonData, pokedexContainer);
            }
          });

          //最初に表示する並び順を指定
          sortSelect.value = "number-asc";
          //プルダウンが選ばれたら発火
          sortSelect.dispatchEvent(new Event("change"));
        } catch (error) {
          console.log("Error:", error);
        }
      }

      async function getRandomPokemonUrls(count) {
        const response = await fetch(
          "https://pokeapi.co/api/v2/pokemon?limit=151"
        );
        const data = await response.json();
        const pokemonList = data.results;
        const randomPokemonUrls = [];
        const shuffledList = shuffle(pokemonList);
        for (let i = 0; i < count; i++) {
          randomPokemonUrls.push(shuffledList[i].url);
        }
        return randomPokemonUrls;
      }

      //シャッフルする関数
      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      window.addEventListener("load", createPokedex);

      //
      //
    </script>
  </body>
</html>
